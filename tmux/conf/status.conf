# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# WezTerm-Integrated Tmux Status Bar
# Uses WezTerm's mode/context detection to provide unified status across both tools
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
CORECFG="$HOME/.core/.sys/cfg"

status_bg_color="#1E2030"

# Deep gray:  #292D3E
# Medium gray: #313244
# Light gray:  #444267
# Accent blue: #987aff
# Jewel green: #01F9C6
# Soft purple: #949ae5
# Darker purple: #5b4996
# Highlight purple: #cba6f7
# Text light:  #cdd6f4
# Text dark:   #F5F5F5


# == Global Status Bar Settings ============================================= [[[
set -g status              2          # Enable status bar
set -g status-position     top        # Position status bar at top
set -g status-interval     5          # Update interval in seconds (balanced for performance)
set -g status-justify      centre     # Position window list in center
set -g status-style        "fg=#01F9C6,bg=#292D3E,default"  # Match WezTerm cyan theme
set -g status-bg           '#1E2030'  # Match WezTerm background
set -g status-left-length  120        # Maximum length of left component (increased for WezTerm mode)
set -g status-right-length 120        # Maximum length of right component
# ]]]

# == Message and Command Styles ============================================= [[[
set -g message-style         "bold,bg=#1E2030,fg=#01F9C6"  # deepgray, jewelgreen
set -g message-command-style "bold,bg=#1E2030,fg=#01F9C6"              # baseblack
# ]]]

# == Status Bar Components ================================================== [[[
# Minimal components to match WezTerm status bar visually
# Left side: matches WezTerm's tabline_a/b/c layout

# Context indicator (tabline_a) - background color changes based on mode
# The script outputs the full formatted segment with dynamic colors

wezterm_color="987aff"  # WezTerm's accent color for consistency
tmux_color="#69FF94"  # Tmux status bar color
tm_context="#($TMUX_MODULES/status/modes/wezterm-context.sh)"

# Right side: minimal system info (matching WezTerm theme with arrow separator)
# Yazibar indicators: show when sidebars are active
# tm_yazibar_left="#{?@yazibar-left-enabled-#{window_id},#[fg=#69FF94] ,}"
# tm_yazibar_right="#{?@yazibar-right-enabled-#{window_id},#[fg=#01F9C6] ,}"
tm_date="#[fg=#987aff,bg=#444267] %I:%M %p "

# tm_div_right_3="#[fg=#444267,bg=#313244]"

tm_host="#[fg=#000000,bg=#987aff] #H"

# tm_current_mode="#($TMUX_MODULES/status/modes/get-tmux-mode.sh)"
tm_gh='#{tmux_gh_uname}'
# tm_div_right_2="#[fg=#444267,bg=#292D3E]#[fg=#987aff,bg=#313244]"
tm_gitmux='󰊢  #(gitmux -cfg $TMUX_MODULES/status/github/gitmux.conf "#{pane_current_path}")'
tm_github='#($TMUX_MODULES/status/github/github-user.sh)'
# session_name=$(tmux display-message -p '#{session_name}' | sed 's/-view-.*//')
# tm_session="#[fg=#987aff,bg=#292D3E]#[fg=#F5F5F5,bg=#987aff]
# ${session_name^}
tm_tabs='#[align=centre]#{W:#{E:window-status-format} ,#{E:window-status-current-format} }'
tm_right="#[align=right]$#($HOME/.core/env/bin/tmux-monitors/local-storage.sh)$tm_date #{tmux_gh_uname}"
tm_left="#[align=left]#($TMUX_MODULES/status/status-left.sh)#[fg=#444267,bg=#313244]$tm_gitmux"
# ]]]


# == Status Bar Content ===================================================== [[[
# Clean, minimal layout matching WezTerm's visual style
# Left: Mode → Context → Session (matches WezTerm tabline_a/b/c)
# Right: Simple date/timeHMS

# set -g status-format[0] "First status bar content: #S | #{pane_current_path}"
set -g status-format[0] "$tm_left $tm_tabs $tm_right"
# #($HOME/.core/env/bin/tmux/rclone-mounts)

set -g status-format[1] "#[align=left]#($TMUX_MODULES/status/storage/cloud-storage.sh)  #($TMUX_MODULES/status/processes/task-progress.sh) #[align=right]#($TMUX_MODULES/status/processes/task-summary.sh) #($TMUX_MODULES/status/status-bottom.sh center) #($TMUX_MODULES/status/backup/backup-progress)"

# set -g status-left "#($TMUX_MODULES/status/status-left.sh)"
# set -g status-right ""
# ]]]

# == Window Status Format =================================================== [[[
# Tab format:
# - Inactive: tab number + basename of cwd (e.g., "1. cfg")
# - Active: parent/basename of cwd (e.g., "cfg/tmux")
# - Background colors: inactive=#444267, active=#949ae5

# Non-active windows: tab number + (custom name OR basename of cwd)
# If window has been renamed (automatic-rename off), show custom name, else show cwd
# Inactive windows

# Active/current window
setw -g window-status-format "#[fg=#5b4996]#[fg=#FFFFFF,bg=#5b4996]#{?window_zoomed_flag,⬢ ,}#I #[fg=#cdd6f4,bg=#45475a] #W #[fg=#45475a,bg=#292D3E] "
setw -g window-status-current-format "#[fg=#01F9C6]#[fg=#1e1e2e,bg=#01F9C6]#{?window_zoomed_flag,⬢ ,}#I #[fg=#cdd6f4,bg=#45475a] #W #[fg=#45475a,bg=#292D3E]  "
setw -g window-status-separator '#[bg=#292D3E]  '
# Active window: (custom name OR parent/basename)

# setw -g window-status-current-format " #[fg=#01F9C6,bg=#444267] #{?automatic-rename,#(basename '#(dirname '#{pane_current_path}')' 2>/dev/null || echo '')/#(basename '#{pane_current_path}'),#W #{?window_zoomed_flag,⬢,}} "
# setw -g window-status-format "#[fg=#01F9C6,bg=#444267] #I. #{?#{==:#{window_flags},*},#W,#{?automatic-rename,#(basename '#{pane_current_path}'),#W #{?window_zoomed_flag,⬢,}}}"

setw -g window-status-style "fg=#01F9C6,bg=#313244"
setw -g window-status-current-style "fg=#01F9C6,bg=#444267"
setw -g window-status-activity-style "bg=#FFFF33"
# ]]]

# # == Window Status Format =================================================== [[[
# # Tab format:
# # - Inactive: tab number + basename of cwd (e.g., "1. cfg")
# # - Active: parent/basename of cwd (e.g., "cfg/tmux")
# # - Background colors: inactive=#444267, active=#949ae5
#
# # Non-active windows: tab number + (custom name OR basename of cwd)
# # If window has been renamed (automatic-rename off), show custom name, else show cwd
# # Inactive windows
#
# active_index_bg="#[fg=#cba6f7]#[fg=#2e1e2e,bg=#cba6f7]"
# active_name_bg="#[fg=#313244,bg=#cba6f7]"
# # active_zoomed_flag="#[fg=#cba6f7,bg=#313244] #{?window_zoomed_flag,⬢,}#[fg=#cba6f7]"
#
# # Active/current window
# setw -g window-status-format "#[fg=#b4befe]#[fg=#1e1e2e,bg=#b4befe] #I #[fg=#cdd6f4,bg=#313244] #W  #{?window_zoomed_flag,⬢,}"
# setw -g window-status-current-format "$active_index_bg#I $active_name_bg#W #{?window_zoomed_flag,⬢,}#[fg=#cba6f7] "
# # Active window: (custom name OR parent/basename)
# # setw -g window-status-current-format " #[fg=#01F9C6,bg=#444267] #{?automatic-rename,#(basename '#(dirname '#{pane_current_path}')' 2>/dev/null || echo '')/#(basename '#{pane_current_path}'),#W #{?window_zoomed_flag,⬢,}} "
# # setw -g window-status-format "#[fg=#01F9C6,bg=#444267] #I. #{?#{==:#{window_flags},*},#W,#{?automatic-rename,#(basename '#{pane_current_path}'),#W #{?window_zoomed_flag,⬢,}}}"
#
# # setw -g window-status-style "fg=#01F9C6,bg=#313244"
# # setw -g window-status-current-style "fg=#01F9C6,bg=#444267"
# setw -g window-status-separator ' '
# setw -g window-status-activity-style "bg=#FFFF33"
# # ]]]
#

# vim: ft=tmux:et:sw=0:ts=2:sts=2:fdm=marker:fmr=[[[,]]]:
