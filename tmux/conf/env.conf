# NOTE: update-environment controls which environment variables are updated when attaching to a session
# Using -r removes ALL variables, which is not what we want. We want to ADD variables instead.
# set -g update-environment -r

# Ensure tmux uses zsh with proper environment
set-option -g default-shell /bin/zsh
set-option -g default-command "${SHELL}"

# Force UTF-8
set -q -g status-utf8 on
setw -q -g utf8 on


# ━━━━ Terminal and Display ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ [[[

set -ga update-environment "DISPLAY"           # X11 display
set -ga update-environment "TERM"
set -ga update-environment "COLORTERM"
set -ga update-environment 'TERM_PROGRAM'   
set -ga update-environment 'WEZTERM_PANE'
set -ga update-environment 'WEZTERM_UNIX_SOCKET'
set -ga update-environment 'WINDOWID'
# set -ga update-environment 'WEZTERM_IN'

# ]]]

# === Terminal and Display ============================================ [[[
# ]]]

# ━━━━ Session and Desktop ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ [[[

set -ga update-environment "XDG_SESSION_ID"
set -ga update-environment "XDG_SESSION_TYPE"  # wayland/x11/tty
set -ga update-environment "XDG_SESSION_CLASS"
set -ga update-environment "XDG_SESSION_DESKTOP"
set -ga update-environment "XDG_CURRENT_DESKTOP"
set -ga update-environment "DESKTOP_SESSION"

# ]]]

# ━━━━ XDG Base Directories ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ [[[

set -ga update-environment "XDG_RUNTIME_DIR"   # /run/user/1000
set -ga update-environment "XDG_CONFIG_HOME"   # ~/.config
set -ga update-environment "XDG_DATA_HOME"     # ~/.local/share
set -ga update-environment "XDG_CACHE_HOME"    # ~/.cache
set -ga update-environment "XDG_STATE_HOME"    # ~/.local/state
set -ga update-environment "XDG_DATA_DIRS"
set -ga update-environment "XDG_CONFIG_DIRS"

# ]]]

# ━━━━User and System━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ [[[
set -ga update-environment "USER"
set -ga update-environment "HOME"
set -ga update-environment "SHELL"
set -ga update-environment "PATH"
set -ga update-environment "SESSION_MANAGER"
set -ga update-environment "LD_LIBRARY_PATH"
set -ga update-environment "MANPATH"
set -ga update-environment "INFOPATH"
# ]]]

# ━━━━ Locale and Language ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ [[[

set -ga update-environment "LANG"
set -ga update-environment "LANGUAGE"
set -ga update-environment "LC_ALL"
set -ga update-environment "LC_CTYPE"
set -ga update-environment "LC_NUMERIC"
set -ga update-environment "LC_TIME"
set -ga update-environment "LC_COLLATE"
set -ga update-environment "LC_MONETARY"
set -ga update-environment "LC_MESSAGES"
set -ga update-environment "LC_PAPER"
set -ga update-environment "LC_NAME"
set -ga update-environment "LC_ADDRESS"
set -ga update-environment "LC_TELEPHONE"
set -ga update-environment "LC_MEASUREMENT"
set -ga update-environment "LC_IDENTIFICATION"

# ]]]

set -ga update-environment "CORE COREBIN CORECFG COREENV COREDEV CORELOGS COREDOCKER COREENV_CONF COREENV_LOCAL COREENV_CACHE CORE_BACKUP COREDOCKER"



set -ga update-environment "OP_SESSION_DXH3ORIHIFH3NNSAKWRK2YOCQM"

# === GUI and Desktop Integration ============================================
# Wayland
set -ga update-environment "WAYLAND_DISPLAY"
set -ga update-environment "WAYLAND_DEBUG"
set -ga update-environment "XDG_SESSION_TYPE"
set -ga update-environment "QT_QPA_PLATFORM"       # qt5/qt6 platform
set -ga update-environment "QT_WAYLAND_DISABLE_WINDOWDECORATION"
set -ga update-environment "QT_QPA_PLATFORMTHEME"
set -ga update-environment "QT_STYLE_OVERRIDE"
set -ga update-environment "QT_IM_MODULE"

# DBus
set -ga update-environment "DBUS_SESSION_BUS_ADDRESS"
set -ga update-environment "DBUS_SYSTEM_BUS_ADDRESS"

# Zsh and Shell
set -ga update-environment "ZDOTDIR"
set -ga update-environment "EDITOR"
set -ga update-environment "VISUAL"
set -ga update-environment "PAGER"
set -ga update-environment "BROWSER"

# FZF (Fuzzy Finder)

set -ga update-environment "FZF_PREVIEW"
set -ga update-environment "FZF_DEFAULT_OPTS"
set -ga update-environment "FZF_DEFAULT_COMMAND"
set -ga update-environment "FZF_TMUX_HEIGHT"
set -ga update-environment "FZF_TMUX_OPTS"
set -ga update-environment "FZF_TMUX_PREVIEW_WINDOW"
set -ga update-environment "FZF_TMUX_BORDER"
set -ga update-environment "FZF_TMUX_CLEAR"
set -ga update-environment "FZF_TMUX_DEFAULT_OPTS"
set -ga update-environment "FZF_TMUX_DEFAULT_COMMAND"
set -ga update-environment "FZF_TMUX_DEFAULT_HEIGHT"
set -ga update-environment "FZF_TMUX_DEFAULT_PREVIEW_WINDOW"
set -ga update-environment "FZF_TMUX_DEFAULT_BORDER"
set -ga update-environment "FZF_TMUX_DEFAULT_CLEAR"

# Ensure WezTerm pane ID is updated (already added above, removing duplicates)
# set -ga update-environment 'WEZTERM_PANE'
# set -ga update-environment 'WEZTERM_UNIX_SOCKET'
# set -ga update-environment 'TERM'
# set -ga update-environment 'TERM_PROGRAM'
# ]]]

# ----------------------------------------------------------------------------
# Authentication and Security
# ----------------------------------------------------------------------------

# SSH
set -ga update-environment "SSH_AUTH_SOCK"     # SSH agent socket
set -ga update-environment "SSH_AGENT_PID"     # SSH agent process ID
set -ga update-environment "SSH_CONNECTION"    # SSH connection info
set -ga update-environment "SSH_CLIENT"        # SSH client info
set -ga update-environment "SSH_TTY"           # SSH tty

# GPG
set -ga update-environment "GPG_TTY"           # GPG terminal
set -ga update-environment "GPG_AGENT_INFO"    # GPG agent info
set -ga update-environment "GNUPGHOME"         # GPG home directory

# X11 (if using)
set -ga update-environment "XAUTHORITY"
set -ga update-environment "XMODIFIERS"
set -ga update-environment "XCURSOR_SIZE"
set -ga update-environment "XCURSOR_THEME"

# ----------------------------------------------------------------------------
# Audio and Media
# ----------------------------------------------------------------------------

set -ga update-environment "PULSE_SERVER"
set -ga update-environment "PULSE_RUNTIME_PATH"
set -ga update-environment "PIPEWIRE_RUNTIME_DIR"
set -ga update-environment "PIPEWIRE_REMOTE"
set -ga update-environment "ALSA_CARD"

# ----------------------------------------------------------------------------
# Development Tools
# ----------------------------------------------------------------------------

# Editors (already added above, removing duplicates)
# set -ga update-environment "EDITOR"
# set -ga update-environment "VISUAL"
# set -ga update-environment "PAGER"
# set -ga update-environment "BROWSER"

# Development
set -ga update-environment "DEBUGINFOD_URLS"
set -ga update-environment "PYTHONPATH"
set -ga update-environment "PERL5LIB"
set -ga update-environment "NODE_PATH"
set -ga update-environment "GOPATH"
set -ga update-environment "CARGO_HOME"
set -ga update-environment "RUSTUP_HOME"

# ----------------------------------------------------------------------------
# System Integration
# ----------------------------------------------------------------------------

# SystemD
set -ga update-environment "SYSTEMD_PAGER"
set -ga update-environment "SYSTEMD_EDITOR"
set -ga update-environment "SYSTEMD_COLORS"
set -ga update-environment "SYSTEMD_LOG_COLOR"
set -ga update-environment "SYSTEMD_LOG_LEVEL"

# Sudo
set -ga update-environment "SUDO_USER"
set -ga update-environment "SUDO_UID"
set -ga update-environment "SUDO_GID"
set -ga update-environment "SUDO_COMMAND"

# ----------------------------------------------------------------------------
# Terminal Specific
# ----------------------------------------------------------------------------

set -ga update-environment "KONSOLE_VERSION"
set -ga update-environment "KONSOLE_PROFILE_NAME"
set -ga update-environment "KITTY_WINDOW_ID"
set -ga update-environment "ALACRITTY_SOCKET"
set -ga update-environment "VTE_VERSION"
set -ga update-environment "TERMINAL_EMULATOR"

# Language
set -ga update-environment "LANGUAGE LANG"


set -ga update-environment "XDG_BIN_DIR XDG_MBIN_DIR BACKUP_DIR WIKI_DIR CORE_VAULT CORE_BACKUP"

# WezTerm configuration
set -ga update-environment "WEZTERM_CONFIG_DIR WEZTERM_CONFIG_FILE WEZTERM_SESSIONS_DIR"
set -ga update-environment "WEZTERM_UTILS WEZTERM_PLUGIN_DIR WEZTERM_THEMES"
set -ga update-environment "WEZTERM_SESSION_THEMES WEZTERM_LOCAL_SESSIONS"
set -ga update-environment "WEZTERM_SSH_SESSIONS WEZTERM_DOCKER_SESSIONS"
set -ga update-environment "WEZTERM_LOG_FILE WEZTERM_DATA"
set -ga update-environment 'WEZTERM_PANE WEZTERM_CONTEXT'

set -ga update-environment "TMUX_CONF TMUX_MODULES TMUX_MENUS TMUX_SCRIPTS TMUX_PLUGIN_MANAGER_PATH TMUX_CACHE_DIR TMUX_TMPDIR TMUX_RESURRECT TMUX_LOGS"
# set-environment -g TMUX_MENUS "$HOME/.core/cfg/tmux/modules/menus"

# Git configuration
set -ga update-environment "GIT_AUTHOR_NAME GIT_AUTHOR_EMAIL"
set -ga update-environment "GIT_COMMITTER_NAME GIT_COMMITTER_EMAIL"
set -ga update-environment "GIT_CONFIG_GLOBAL GIT_CONFIG_SYSTEM GIT_EDITOR"

set -ga update-environment "YAZI_LOG YAZI_CONFIG_DIR YAZI_PLUGIN_DIR YAZI_CONFIG_HOME YAZI_PREVIEW_MODE"

# Set default yazi preview mode to "dual" (uses yazi for preview with sync)
# Options: "dds" (bash preview), "native" (yazi preview-only), "dual" (synced yazi)
set-environment -g YAZI_PREVIEW_MODE "dual"

set -ga update-environment "NVIMD NVIMRC NVIM_CONFIG_DIR NVIM_CACHE_DIR NVIM_PLUGIN_DIR NVIM_PYTHON_LOG_FILE NVIM_NODE_LOG_FILE NVIM_PLUGIN_CACHE_DIR"

set -ga update-environment "RIPGREP_CONFIG_PATH BAT_CONFIG_PATH"
set -ga update-environment "CURL_HOME WGETRC"
set -ga update-environment "MYCLI_HISTFILE MYSQL_HISTFILE SQLITE_HISTORY"
set -ga update-environment "TASKRC TASKDATA TASKOPENRC"

# ============================================================================
# NOTE: Terminal capabilities, server settings, and modern features moved to term.conf
# ============================================================================
# The following settings have been moved to term.conf to avoid duplication:
# - default-terminal
# - allow-passthrough
# - terminal-features (RGB, sixel, etc.)
# - terminal-overrides
# - server settings (editor, set-clipboard, escape-time, exit-empty, focus-events, buffer-limit)
# - xterm-keys
# - display and performance settings
# - modern terminal features (usstyle, overline, sync, extkeys)

# vim: ft=tmux:et:sw=0:ts=2:sts=2:fdm=marker:fmr=[[[,]]]:
