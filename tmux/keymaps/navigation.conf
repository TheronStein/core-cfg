# ==============================================================================
# Seamless Navigation: Terminal <-> Tmux <-> Neovim
# ==============================================================================
# Uses Ctrl+Shift+W/A/S/D throughout all layers
#
# How it works:
#   1. If nvim is running (detected via @pane-is-vim): pass keys to nvim
#   2. If at tmux edge: call terminal-nav to navigate terminal panes
#   3. Otherwise: navigate tmux panes
#
# Requirements:
#   - smart-splits.nvim in neovim (sets @pane-is-vim)
#   - terminal-nav script in PATH (~/.local/bin/terminal-nav)
# ==============================================================================

# Terminal navigation script
TNAV="$HOME/.local/bin/terminal-nav"

# Ctrl+Shift+W - Navigate Up
bind-key -n C-S-w if-shell -F "#{@pane-is-vim}" \
    "send-keys C-S-w" \
    "if-shell -F '#{pane_at_top}' 'run-shell \"$TNAV up\"' 'select-pane -U'"

# Ctrl+Shift+S - Navigate Down
bind-key -n C-S-s if-shell -F "#{@pane-is-vim}" \
    "send-keys C-S-s" \
    "if-shell -F '#{pane_at_bottom}' 'run-shell \"$TNAV down\"' 'select-pane -D'"

# Ctrl+Shift+A - Navigate Left
bind-key -n C-S-a if-shell -F "#{@pane-is-vim}" \
    "send-keys C-S-a" \
    "if-shell -F '#{pane_at_left}' 'run-shell \"$TNAV left\"' 'select-pane -L'"

# Ctrl+Shift+D - Navigate Right
bind-key -n C-S-d if-shell -F "#{@pane-is-vim}" \
    "send-keys C-S-d" \
    "if-shell -F '#{pane_at_right}' 'run-shell \"$TNAV right\"' 'select-pane -R'"

# Copy mode bindings (always navigate tmux, nvim not active)
bind-key -T copy-mode-vi C-S-w select-pane -U
bind-key -T copy-mode-vi C-S-s select-pane -D
bind-key -T copy-mode-vi C-S-a select-pane -L
bind-key -T copy-mode-vi C-S-d select-pane -R
