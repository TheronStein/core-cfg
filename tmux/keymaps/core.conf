# == TMUX Necessities Keybindings ==
#
# Reload tmux config
bind C-r source-file "$HOME/.core/cfg/tmux/tmux.conf" \; display-message "Config reloaded"

# Save with timestamp feedback
bind-key M-s run-shell 'bash -c "$HOME/.core/cfg/tmux/plugins/tmux-resurrect/scripts/save.sh && tmux display-message \"Session saved at $(date +%H:%M:%S)\""'

# Restore with file selection
bind-key M-r run-shell 'bash -c '\''
  if [ -d "$TMUX_RESURRECT" ]; then
    file=$(ls -t "$TMUX_RESURRECT"/*.txt 2>/dev/null | head -1)
    if [ -n "$file" ]; then
      "$TMUX_PLUGIN_MANAGER_PATH"/tmux-resurrect/scripts/restore.sh
      tmux display-message "Restored from: $(basename "$file")"
    else
      tmux display-message "No save files found"
    fi
  else
    tmux display-message "Resurrect directory not found"
  fi'\'''

# Interactive save file browser (requires fzf and display-popup support)
bind-key M-R run-shell 'bash -c '\''
  cd "$TMUX_RESURRECT" 2>/dev/null || exit 1
  file=$(ls -t *.txt 2>/dev/null | fzf --prompt="Select save file: " --height=40%)
  if [ -n "$file" ]; then
    cp "$file" last
    tmux display-message "Will restore from: $file"
  fi
  read -p "Press Enter to close..."'\'''


# == File Navigation ==
# OLD SIDEBAR BINDINGS - DISABLED (replaced by yazibar module)
# bind -n -N "Toggle yazi sidebar" M-f run-shell '$HOME/.core/cfg/tmux/scripts/yazi-sidebar-manager.sh toggle'
# bind -n -N "Focus yazi sidebar" M-g run-shell '$HOME/.core/cfg/tmux/scripts/yazi-sidebar-manager.sh focus'
# bind -n -N "Toggle yazi preview pane" M-F run-shell '$HOME/.core/cfg/tmux/scripts/toggle-yazi-preview.sh'

# Yazibar keybindings are loaded from:
# $TMUX_CONF/modules/yazibar/conf/keybindings.conf

bind M-s run-shell "$CORECFG/tmux/modules/sidebar/toggle.sh '$value' '#{pane_id}'"

# # == File Navigation ==
# # Toggle yazi sidebar (session-scoped docked sidebar)
# bind -n -N "Toggle yazi sidebar" M-f run-shell '$HOME/.core/cfg/tmux/scripts/yazi-sidebar-manager.sh toggle'
#
# # Toggle yazi preview pane (right side)
# bind -n -N "Toggle yazi preview pane" M-F run-shell '$HOME/.core/cfg/tmux/scripts/toggle-yazi-preview.sh'
