# Yazibar - Keybindings Configuration
# Default keybindings for yazibar module

# Script directory
%hidden YAZIBAR_SCRIPTS="$TMUX_MODULES/yazibar/scripts"

# ============================================================================
# LEFT SIDEBAR (File Navigation)
# ============================================================================

# Toggle BOTH sidebars together (with sync)
bind -n M-e run-shell "$YAZIBAR_SCRIPTS/yazibar-both.sh toggle"

# Toggle left sidebar
bind -n M-f run-shell "$YAZIBAR_SCRIPTS/yazibar-left.sh toggle"

# Focus left sidebar (create if doesn't exist)
bind -n M-g run-shell "$YAZIBAR_SCRIPTS/yazibar-left.sh focus"

# Resize left sidebar wider (prefix + >)
bind > run-shell "$YAZIBAR_SCRIPTS/yazibar-left.sh resize-wider"

# Resize left sidebar narrower (prefix + <)
bind < run-shell "$YAZIBAR_SCRIPTS/yazibar-left.sh resize-narrower"

# ============================================================================
# RIGHT SIDEBAR (Preview)
# ============================================================================

# Toggle right sidebar
bind -n M-F run-shell "$YAZIBAR_SCRIPTS/yazibar-right.sh toggle"

# Focus right sidebar (create if doesn't exist)
bind -n M-G run-shell "$YAZIBAR_SCRIPTS/yazibar-right.sh focus"

# Resize right sidebar wider (prefix + .)
# Note: M-[ and M-] conflict with terminal escape sequences, so we use prefix bindings
bind . run-shell "$YAZIBAR_SCRIPTS/yazibar-right.sh resize-wider"

# Resize right sidebar narrower (prefix + ,)
bind , run-shell "$YAZIBAR_SCRIPTS/yazibar-right.sh resize-narrower"

# ============================================================================
# SYNCHRONIZATION
# ============================================================================

# Toggle input synchronization
bind -n M-S run-shell "$YAZIBAR_SCRIPTS/yazibar-sync.sh toggle"

# ============================================================================
# STATUS
# ============================================================================

# Show yazibar status
bind M-? run-shell "tmux display-popup -E -w 80% -h 60% '\
    echo \"=== YAZIBAR STATUS ===\";\
    echo \"\";\
    $YAZIBAR_SCRIPTS/yazibar-left.sh status;\
    echo \"\";\
    $YAZIBAR_SCRIPTS/yazibar-right.sh status;\
    echo \"\";\
    $YAZIBAR_SCRIPTS/yazibar-width.sh list;\
    echo \"\";\
    read -p \"Press Enter to close...\"'"

# ============================================================================
# NVIM INTEGRATION
# ============================================================================

# Register current nvim instance
# bind -n M-n run-shell "$YAZIBAR_SCRIPTS/yazibar-nvim.sh register"

# Show nvim status
bind -n M-N run-shell "tmux display-popup -E -w 60% -h 40% '\
    $YAZIBAR_SCRIPTS/yazibar-nvim.sh status;\
    echo \"\";\
    read -p \"Press Enter to close...\"'"

# ============================================================================
# RCLONE BROWSER
# ============================================================================

# Toggle rclone browser (left sidebar: browser, right sidebar: preview)
bind -n M-r run-shell "$TMUX_MODULES/browsers/rclone-browser/toggle-rclone-browser.sh toggle"

# Focus rclone browser (left pane)
bind -n M-R run-shell "$TMUX_MODULES/browsers/rclone-browser/toggle-rclone-browser.sh focus-left"
