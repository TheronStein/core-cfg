#!/usr/bin/env zsh
# Grab all files in a directory recursively

local dir="${1:-.}"
local pattern="${2:-*}"
local files=""
local count=0

# Find all matching files
while IFS= read -r file; do
    files+="=== $file ===\n"
    files+="$(bat --style=plain --paging=never "$file" 2>/dev/null || cat "$file")\n\n"
    ((count++))
done < <(fd --type f "$pattern" "$dir")

if [[ $count -gt 0 ]]; then
    echo -e "$files" | wl-copy
    echo "âœ“ Copied $count files from $dir to clipboard"
else
    echo "No files found matching pattern: $pattern in $dir"
    return 1
fi
